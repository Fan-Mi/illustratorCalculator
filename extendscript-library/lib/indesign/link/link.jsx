/** * Module with indesign link functions * @namespace Link * @memberOf IN * @author Bastien Eichenberger */IN.Link = (function (my) {    /**     * Function to check if a link contains an bitmap image     * @function is_image_bitmap     * @memberOf IN.Link     * @param {Link} link, the indesign link object     * @return {Boolean} true if the link is a bitmap image     */    my.is_bitmap = function (link) {        var image = link.parent;        var black_and_white_key = app.translateKeyString("$ID/#Links_Black and White");        if (image.constructor.name === "Image") {            if (image.space == black_and_white_key) {                return true;            }        }        return false;    }    /**     * Function who check if a link is proportional or not     * @function is_proportional     * @memberOf IN.Link     * @param {Link} link, the indesign link object     * @param {number} precision, the desired precision     * @return {Boolean} true if the link is proportional     */    my.is_proportional = function (link, precision) {        var image = link.parent;        var precision = 2 || precision;        var horizontal_scale = image.horizontalScale.roundTo(precision);        var vertical_scale = image.verticalScale.roundTo(precision);        if (horizontal_scale === vertical_scale) {            return true;        }        return false;    }    /**     * Function to count the number of times that the same link is used     * @param link     * @param {Document} doc_to_check the indesign document     * @returns {number}     */    my.count = function (link, doc) {        var array_all_links = doc.links;        var counter = 0;        for (var i = 0; i < array_all_links.length; i++) {            var current_link = array_all_links[i];            if (link.filePath === current_link.filePath) {                counter++;            }        }        return counter;    }    /**     * Function to check if the same file is used many times (image, PDF)     * @function is_used     * @memberOf IN.Document     * @param {Link} link_item the link item     * @param {Document} [document] the indesign document     * @return {number} number the number of time that this link is used     */    my.is_used = function (link, document) {        if (document === undefined) {            var document = app.activeDocument;        }        var links = document.links;        var count = 0;        for (var i = 0; i < links.length; i++) {            if (link.filePath === links[i].filePath) {                count++;            }        }        return count;    }    return my;})(IN.Link || {});