/** * Module with indesign page items functions * @namespace PageItem * @memberOf IN * @author Maya Jeanmonod */IN.PageItem = (function (my) {    /**     * Function to get the height of a page item     * @function get_height     * @memberOf IN.PageItem     * @param pageItem the item that you want to get the height     * @return {number} the height of the page item     */    my.get_height = function (pageItem) {        var item_height = pageItem.geometricBounds[2] - pageItem.geometricBounds[0];        return item_height;    }    /**     * Function to get the width of a page item     * @function get_width     * @memberOf IN.PageItem     * @param pageItem the item that you want to get the width     * @return {number} the width of the page item     */    my.get_width = function (pageItem) {        var item_width = pageItem.geometricBounds[3] - pageItem.geometricBounds[1];        return item_width;    }    /**     * Function to calculate the horizontal ratio     * @function get_horizontal_scale     * @memberOf IN.PageItem     * @param {Group} grp an InDesign group of object     * @return {number} the ratio in percent     */    my.get_horizontal_scale = function (grp) {        var page_width, grp_width, ratio;        // calculate the ratio        pageWidth = app.activeDocument.documentPreferences.pageWidth;        // visibleBounds ([y1, x1, y2, x2] coordinates including the stroke)        grpWidth = IN.PageItem.getWidth(grp);        ratio = (page_width / grp_width) * 100;        return ratio;    }    /**     * Function to calculate the vertical ratio     * @function get_Vertical_scale     * @memberOf IN.PageItem     * @param {Group} grp an InDesign group of object     * @return {number} the ratio in percent     */    my.get_Vertical_scale = function (grp) {        var page_height, grp_height, ratio;        // calculate the ratio        pageHeight = app.activeDocument.documentPreferences.pageHeight;        // visibleBounds ([y1, x1, y2, x2] coordinates including the stroke)        grpHeight = IN.PageItem.getHeight(grp);        ratio = (page_height / grp_height) * 100;        return ratio;    }    /**     * Function to group all items of the current page     * @function group_all     * @memberOf IN.PageItem     * @todo check how to deal with a document with many pages     */    my.group_all = function () {        var itemsToGroup = app.activeDocument.pageItems.everyItem();        app.activeDocument.groups.add(itemsToGroup);    }    /**     * Function to ungroup all page items     * @function ungroup_all     * @memberOf IN.PageItem     * @todo check how to deal with a document with many pages     */    my.ungroup_all = function () {        app.activeDocument.groups.everyItem().ungroup();    }    return my;})(IN.PageItem || {});