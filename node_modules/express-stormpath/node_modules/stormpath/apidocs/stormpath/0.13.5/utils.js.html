<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

var cryptoLib = require('crypto');
/* jshint -W079 */
var Buffer = require('buffer').Buffer;
/* jshint +W079 */
var util = require('util');

var uuid = require('node-uuid');

function shallowCopy(src, dest) {

  for (var key in src) {
    if (src.hasOwnProperty(key)) {
      dest[key] = src[key];
    }
  }

  return dest;
}

/**
 * Ensures 'undefined' is never encountered on value assignment.  Works as follows:
 * 1. Return obj if not null or undefined.
 * 2. Then return defaultVal if not null or undefined.
 * 3. Return null as last resort.
 * &lt;p/>
 * Example usage:
 *
 * &lt;pre>
 * function(someVal) {
 *   var possiblyNullButNeverUndefined = util.valueOf(someVal.foo);
 * }
 * &lt;/pre>
 * or:
 * &lt;pre>
 * function(someVal) {
 *   var fooOrDefaultValueIfFooDoesNotExist = util.valueOf(someVal.foo, 'DefaultVavlue');
 * }
 * &lt;/pre>
 *
 * @param obj
 * @param [defaultVal]
 * @returns {*}
 */
function valueOf(obj, defaultVal) {
  if (obj) {
    return obj;
  }
  if (defaultVal) {
    return defaultVal;
  }
  return null;
}


/**
 * Returns &lt;code>true&lt;/code> if the first constructor function is equal to, or a super of, the second constructor
 * function.
 *
 * @param ctor the constructor function that might be equal to or a super of 'toTest'.
 * @param toTest the constructor function to test
 */
function isAssignableFrom(ctor, toTest) {

  if (!(ctor instanceof Function) || !(toTest instanceof Function)) {
    throw new Error("arguments must be Functions.");
  }

  if (ctor === Object || ctor === toTest) {
    return true;
  }

  if (toTest.super_) {
    return isAssignableFrom(ctor, toTest.super_);
  }

  return false;
}

var base64 = {
  encode: function encode64(string) {
    return new Buffer(string).toString('base64');
  },
  decode: function decode64(string) {
    return new Buffer(string, 'base64').toString();
  },
  urlEncode: function urlEncode(string){
    return new Buffer(string).toString('base64').replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');
  },
  urlDecode: function urlDecode(base64){
    base64 += new Array(5 - base64.length % 4).join('=');
    base64 = base64.replace(/\-/g, '+').replace(/\_/g, '/');
    return new Buffer(base64, 'base64');
  }
};

var crypto = {
  hmac: function hmac(key, string, digest, fn) {
    if (!digest) {
      digest = 'binary';
    }
    if (digest === 'buffer') {
      digest = undefined;
    }
    if (!fn) {
      fn = 'sha256';
    }
    if (typeof string === 'string') {
      string = new Buffer(string);
    }
    return cryptoLib.createHmac(fn, key).update(string).digest(digest);
  },

  sha256: function sha256(string, digest) {
    if (!digest) {
      digest = 'binary';
    }
    if (digest === 'buffer') {
      digest = undefined;
    }
    if (typeof string === 'string') {
      string = new Buffer(string);
    }
    return cryptoLib.createHash('sha256').update(string).digest(digest);
  },

  toHex: function toHex(data) {
    var out = [];
    for (var i = 0; i &lt; data.length; i++) {
      out.push(('0' + data.charCodeAt(i).toString(16)).substr(-2, 2));
    }
    return out.join('');
  }
};

function isCollectionData(data) {
  return data &amp;&amp;
    data.hasOwnProperty('items') &amp;&amp;
    data.hasOwnProperty('offset') &amp;&amp;
    data.hasOwnProperty('limit');
}

function nowEpochSeconds(){
  return Math.round(new Date().getTime()/1000);
}

var numberRegExp = new RegExp(/[0-9]+/);

function isNumber(val){
  return (typeof val === 'number') &amp;&amp; numberRegExp.test(val,10);
}

module.exports = {
  nowEpochSeconds: nowEpochSeconds,
  inherits: util.inherits,
  isAssignableFrom: isAssignableFrom,
  isCollectionData: isCollectionData,
  shallowCopy: shallowCopy,
  valueOf: valueOf,
  isNumber: isNumber,
  base64: base64,
  crypto: crypto,
  uuid: uuid,
  noop: function () {
  }
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Cache.html">Cache</a></li><li><a href="CacheEntry.html">CacheEntry</a></li><li><a href="CacheManager.html">CacheManager</a></li><li><a href="CacheStats.html">CacheStats</a></li><li><a href="Client.html">Client</a></li><li><a href="DataStore.html">DataStore</a></li><li><a href="JwtAuthenticationResult.html">JwtAuthenticationResult</a></li><li><a href="MemcachedStore.html">MemcachedStore</a></li><li><a href="ObjectCallProxy.html">ObjectCallProxy</a></li><li><a href="RedisStore.html">RedisStore</a></li><li><a href="RequestExecutor.html">RequestExecutor</a></li></ul><h3>Global</h3><ul><li><a href="global.html#createResource">createResource</a></li><li><a href="global.html#defaults">defaults</a></li><li><a href="global.html#getAuthenticator">getAuthenticator</a></li><li><a href="global.html#getResource">getResource</a></li><li><a href="global.html#instantiate">instantiate</a></li><li><a href="global.html#isAssignableFrom">isAssignableFrom</a></li><li><a href="global.html#valueOf">valueOf</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.3</a> on Wed Nov 11 2015 11:00:40 GMT-0800 (PST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
